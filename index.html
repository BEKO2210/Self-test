<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>BELKIS_OS v3.0 — SYSTEM DIAGNOSTIC</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;600;700&family=Syne:wght@400;700;800&display=swap');

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        :root {
            --accent: #ff4400;
            --accent-glow: rgba(255, 68, 0, 0.4);
            --bg: #050505;
            --text: #e5e5e5;
            --muted: #555;
            --dim: #333;
            --loader-one: #ff6a33;
            --loader-two: #cc2200;
            --loader-three: rgba(255,106,51,0.5);
            --loader-four: rgba(204,34,0,0.5);
            --loader-five: rgba(255,106,51,0.25);
            --anim-time: 2s;
            --safe-top: env(safe-area-inset-top, 0px);
            --safe-bottom: env(safe-area-inset-bottom, 0px);
        }

        html, body {
            height: 100%;
            overflow: hidden;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background-color: var(--bg);
            color: var(--text);
            -webkit-font-smoothing: antialiased;
            user-select: none;
            -webkit-user-select: none;
        }

        /* ═══════════════ BACKGROUND LAYERS ═══════════════ */
        .noise {
            position: fixed; inset: 0;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMDAiIGhlaWdodD0iMzAwIj48ZmlsdGVyIGlkPSJnIj48ZmVUdXJidWxlbmNlIHR5cGU9ImZyYWN0YWxOb2lzZSIgYmFzZUZyZXF1ZW5jeT0iMC43IiBudW1PY3RhdmVzPSI0IiBzdGl0Y2hUaWxlcz0ic3RpdGNoIi8+PC9maWx0ZXI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsdGVyPSJ1cmwoI2cpIiBvcGFjaXR5PSIwLjA0Ii8+PC9zdmc+');
            pointer-events: none; z-index: 0; opacity: 0.5;
        }

        .scanline {
            position: fixed; width: 100%; height: 100px; z-index: 1;
            background: linear-gradient(0deg, transparent 0%, rgba(255,255,255,0.015) 50%, transparent 100%);
            bottom: 100%;
            animation: scanline 8s linear infinite;
            pointer-events: none;
        }
        @keyframes scanline { 0%{bottom:100%} 100%{bottom:-100px} }

        .grid-bg {
            position: fixed; inset: 0; z-index: 0; pointer-events: none; opacity: 0.025;
            background-image:
                linear-gradient(rgba(255,68,0,0.3) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,68,0,0.3) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        /* ═══════════════ APP SHELL ═══════════════ */
        .app {
            position: relative; z-index: 10;
            width: 100%; max-width: 460px;
            height: 100%; 
            margin: 0 auto;
            display: flex; flex-direction: column;
            padding: calc(1rem + var(--safe-top)) 1.25rem calc(0.75rem + var(--safe-bottom));
        }

        /* ═══════════════ HEADER ═══════════════ */
        .header {
            display: flex; justify-content: space-between; align-items: flex-end;
            border-bottom: 1px solid rgba(255,255,255,0.06);
            padding-bottom: 0.75rem; margin-bottom: 0;
            flex-shrink: 0;
        }
        .header-label { font-size: 8px; color: var(--muted); letter-spacing: 0.2em; text-transform: uppercase; margin-bottom: 3px; }
        .header-title { font-family: 'Syne', sans-serif; font-size: 13px; font-weight: 700; color: #fff; letter-spacing: 0.12em; }
        .header-status { font-size: 10px; font-weight: 600; color: var(--accent); letter-spacing: 0.12em; }

        /* ═══════════════ CONTENT AREA ═══════════════ */
        .content-area {
            flex: 1;
            min-height: 0;
            position: relative;
        }

        /* ═══════════════ SCREENS ═══════════════ */
        .screen {
            position: absolute; inset: 0;
            display: flex; flex-direction: column;
            justify-content: center;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            padding: 1rem 0;
            scrollbar-width: none;
        }
        .screen::-webkit-scrollbar { display: none; }
        .screen.hidden { display: none; }
        .screen.fade-out { animation: fadeOut 0.3s ease forwards; pointer-events: none; }
        .screen.fade-in { animation: fadeIn 0.45s cubic-bezier(0.16,1,0.3,1) forwards; }
        @keyframes fadeOut { to { opacity:0; transform: translateY(-6px); } }
        @keyframes fadeIn { from { opacity:0; transform: translateY(10px); } to { opacity:1; transform: translateY(0); } }

        /* ═══════════════ SVG MORPH ORB ═══════════════ */
        .orb-wrap { flex-shrink: 0; margin-bottom: 1.5rem; }
        .orb-loader {
            position: relative;
            width: 80px; height: 80px;
            border-radius: 50%;
            box-shadow: 0 0 25px 0 var(--loader-three), 0 15px 40px 0 var(--loader-four);
            animation: orbColorize calc(var(--anim-time) * 3) ease-in-out infinite;
        }
        .orb-loader::before {
            content: ""; position: absolute; inset: 0;
            border-radius: 50%;
            border-top: 1px solid var(--loader-one);
            border-bottom: 1px solid var(--loader-two);
            background: linear-gradient(180deg, var(--loader-five), var(--loader-four));
            box-shadow: inset 0 8px 8px 0 var(--loader-three), inset 0 -8px 8px 0 var(--loader-four);
        }
        .orb-fill {
            width: 80px; height: 80px;
            background: linear-gradient(180deg, var(--loader-one) 30%, var(--loader-two) 70%);
            mask: url(#morph-mask); -webkit-mask: url(#morph-mask);
        }
        .orb-loader > svg {
            position: absolute; top: 0; left: 0;
            width: 80px; height: 80px;
        }

        /* SVG mask animations — target by ID globally */
        #morph-mask { filter: contrast(15); animation: orbRound calc(var(--anim-time)/2) linear infinite; }
        #morph-mask polygon { filter: blur(5px); }
        #morph-mask polygon:nth-child(1) { transform-origin:75% 25%; transform:rotate(90deg); }
        #morph-mask polygon:nth-child(2) { transform-origin:50% 50%; animation: orbSpin var(--anim-time) linear infinite reverse; }
        #morph-mask polygon:nth-child(3) { transform-origin:50% 60%; animation: orbSpin var(--anim-time) linear infinite; animation-delay: calc(var(--anim-time)/-3); }
        #morph-mask polygon:nth-child(4) { transform-origin:40% 40%; animation: orbSpin var(--anim-time) linear infinite reverse; }
        #morph-mask polygon:nth-child(5) { transform-origin:40% 40%; animation: orbSpin var(--anim-time) linear infinite reverse; animation-delay: calc(var(--anim-time)/-2); }
        #morph-mask polygon:nth-child(6) { transform-origin:60% 40%; animation: orbSpin var(--anim-time) linear infinite; }
        #morph-mask polygon:nth-child(7) { transform-origin:60% 40%; animation: orbSpin var(--anim-time) linear infinite; animation-delay: calc(var(--anim-time)/-1.5); }

        @keyframes orbSpin { to { transform: rotate(360deg); } }
        @keyframes orbRound { 0%{filter:contrast(15)} 20%{filter:contrast(3)} 40%{filter:contrast(3)} 60%{filter:contrast(15)} 100%{filter:contrast(15)} }
        @keyframes orbColorize { 0%{filter:hue-rotate(0)} 25%{filter:hue-rotate(-25deg)} 50%{filter:hue-rotate(-50deg)} 75%{filter:hue-rotate(-25deg)} 100%{filter:hue-rotate(0)} }

        /* ═══════════════ LETTER WAVE ═══════════════ */
        .letter-wave {
            display: flex; flex-wrap: wrap;
            align-items: center; justify-content: flex-start;
            margin-bottom: 0.25rem;
            gap: 0;
        }
        .letter-wave span {
            display: inline-block; font-family: 'Syne', sans-serif;
            font-size: clamp(1.6rem, 7.5vw, 2.8rem);
            font-weight: 800; color: #fff;
            opacity: 0.3; animation: letterPulse 2.4s infinite;
            line-height: 1.15;
        }
        .letter-wave span.space { width: 0.3em; }
        @keyframes letterPulse {
            0%,100% { opacity:0.3; transform:translateY(0) scale(1); }
            18% { opacity:1; transform:translateY(-2px) scale(1.06); color: var(--accent); text-shadow: 0 0 15px var(--accent-glow); }
            36% { opacity:0.5; transform:translateY(0) scale(1); }
        }

        /* ═══════════════ BOOT LINES ═══════════════ */
        .boot-lines { margin: 1.25rem 0; flex-shrink: 0; }
        .boot-line {
            font-size: 10px; color: var(--muted); margin-bottom: 5px;
            opacity: 0; animation: bootType 0.4s ease forwards;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        .boot-line .check { color: #22c55e; margin-right: 5px; }
        @keyframes bootType { from{opacity:0;transform:translateX(-5px)} to{opacity:1;transform:translateX(0)} }
        @keyframes blinker { 50%{opacity:0} }

        /* ═══════════════ START BUTTON ═══════════════ */
        .start-btn {
            display: inline-flex; align-items: center; gap: 10px;
            background: none; border: 1px solid rgba(255,68,0,0.3);
            color: #fff; font-family: 'Syne', sans-serif; font-size: 13px;
            font-weight: 700; letter-spacing: 0.12em; padding: 12px 24px;
            cursor: pointer; transition: all 0.3s ease;
            position: relative; overflow: hidden; flex-shrink: 0;
        }
        .start-btn::before {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(90deg, transparent, rgba(255,68,0,0.08), transparent);
            transform: translateX(-100%); transition: transform 0.5s ease;
        }
        .start-btn:hover { border-color: var(--accent); color: var(--accent); box-shadow: 0 0 25px rgba(255,68,0,0.15); }
        .start-btn:hover::before { transform: translateX(100%); }
        .start-btn:active { transform: scale(0.97); background: rgba(255,68,0,0.08); }
        .start-btn .arrow { transition: transform 0.3s ease; font-size: 16px; }
        .start-btn:hover .arrow { transform: translateX(4px); }

        /* ═══════════════ QUESTION SCREEN ═══════════════ */
        .q-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.25rem; flex-shrink: 0; }
        .q-badge {
            font-size: 10px; color: var(--accent); border: 1px solid var(--accent);
            padding: 2px 7px; border-radius: 2px; font-weight: 600;
        }
        .q-module { font-size: 9px; color: var(--dim); letter-spacing: 0.18em; text-transform: uppercase; }

        .q-text {
            font-family: 'Syne', sans-serif;
            font-size: clamp(1.1rem, 4.5vw, 1.5rem);
            font-weight: 700; color: #fff; line-height: 1.35;
            margin-bottom: 2rem; min-height: 2.5rem;
            flex-shrink: 0;
        }
        .q-text.anim-in { animation: slideReveal 0.45s cubic-bezier(0.16,1,0.3,1) forwards; }
        @keyframes slideReveal { from{opacity:0;transform:translateY(12px);filter:blur(3px)} to{opacity:1;transform:translateY(0);filter:blur(0)} }

        .scan-orb {
            position: absolute; top: 0.5rem; right: 0;
            width: 35px; height: 35px; border-radius: 50%;
            background: radial-gradient(circle, var(--accent) 0%, transparent 70%);
            opacity: 0.12; filter: blur(6px);
            animation: scanPulse 2s ease-in-out infinite;
            pointer-events: none; z-index: -1;
        }
        @keyframes scanPulse { 0%,100%{transform:scale(1);opacity:0.12} 50%{transform:scale(1.4);opacity:0.25} }

        /* ═══ Answer Buttons ═══ */
        .answers { display: flex; flex-direction: column; gap: 8px; }
        .ans-btn {
            position: relative; width: 100%; text-align: left;
            padding: 12px 14px; font-size: 12px; font-family: 'JetBrains Mono', monospace;
            color: rgba(255,255,255,0.5); background: transparent;
            border: none; border-left: 2px solid rgba(255,255,255,0.06);
            cursor: pointer; transition: all 0.2s ease; overflow: hidden;
            opacity: 0; animation: ansSlide 0.35s cubic-bezier(0.16,1,0.3,1) forwards;
            flex-shrink: 0;
        }
        .ans-btn::before {
            content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 0;
            background: rgba(255,68,0,0.06); transition: width 0.25s ease;
        }
        .ans-btn:hover, .ans-btn:active { color: #fff; border-left-color: var(--accent); }
        .ans-btn:hover::before, .ans-btn:active::before { width: 100%; }
        .ans-btn:active { background: rgba(255,68,0,0.1); }
        .ans-btn .opt-tag { font-size: 8px; color: var(--dim); margin-right: 8px; transition: color 0.2s; }
        .ans-btn:hover .opt-tag, .ans-btn:active .opt-tag { color: var(--accent); }
        @keyframes ansSlide { from{opacity:0;transform:translateX(-8px)} to{opacity:1;transform:translateX(0)} }

        .ans-btn.selected { border-left-color: var(--accent); color: var(--accent); animation: ansFlash 0.25s ease; }
        @keyframes ansFlash { 0%{background:rgba(255,68,0,0.2)} 100%{background:transparent} }

        /* ═══════════════ RESULT SCREEN ═══════════════ */
        .result-orb-wrap {
            position: relative;
            width: 130px; height: 130px;
            margin: 0 auto 1.5rem;
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0;
        }
        .result-orb-ring {
            position: absolute; inset: 0; border-radius: 50%;
            border: 2px solid transparent; border-top-color: var(--accent);
            animation: resultSpin 3s linear infinite;
        }
        .result-orb-ring:nth-child(2) {
            inset: 7px; border-top-color: transparent; border-right-color: var(--accent);
            animation-duration: 2s; animation-direction: reverse; opacity: 0.5;
        }
        .result-orb-ring:nth-child(3) {
            inset: 14px; border-top-color: transparent; border-bottom-color: var(--accent);
            animation-duration: 4s; opacity: 0.3;
        }
        @keyframes resultSpin { to{transform:rotate(360deg)} }

        .result-score {
            font-family: 'Syne', sans-serif; font-size: 3rem; font-weight: 800;
            color: #fff; z-index: 2; line-height: 1;
        }
        .result-score .unit { font-size: 1rem; color: var(--dim); font-weight: 400; }

        .result-divider { height: 1px; width: 100%; margin: 0.25rem 0 1.25rem; position: relative; overflow: hidden; flex-shrink: 0; }
        .result-divider::after {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            animation: dividerGlow 2s ease-in-out infinite;
        }
        @keyframes dividerGlow { 0%,100%{opacity:0.4} 50%{opacity:1} }

        .result-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 1.25rem; flex-shrink: 0; }
        .result-cell { text-align: center; }
        .result-cell-label { font-size: 8px; color: var(--dim); letter-spacing: 0.15em; text-transform: uppercase; margin-bottom: 3px; }
        .result-cell-val { font-size: 11px; color: #fff; font-weight: 600; }
        .result-cell-bar { height: 2px; background: rgba(255,255,255,0.08); margin-top: 5px; border-radius: 1px; overflow: hidden; }
        .result-cell-bar-fill { height: 100%; background: var(--accent); transition: width 1s cubic-bezier(0.22,1,0.36,1); width: 0; }

        .result-title { font-family: 'Syne', sans-serif; font-size: 1rem; font-weight: 700; margin-bottom: 0.3rem; letter-spacing: 0.08em; flex-shrink: 0; }
        .result-desc { font-size: 11px; color: rgba(255,255,255,0.4); line-height: 1.65; margin-bottom: 1.5rem; }

        .reboot-btn {
            font-size: 9px; color: var(--muted); letter-spacing: 0.18em; text-transform: uppercase;
            background: none; border: none; border-top: 1px solid rgba(255,255,255,0.06);
            padding-top: 0.75rem; cursor: pointer; text-align: left; width: 100%;
            font-family: 'JetBrains Mono', monospace; transition: color 0.2s; flex-shrink: 0;
        }
        .reboot-btn:hover, .reboot-btn:active { color: var(--accent); }

        /* ═══════════════ FOOTER ═══════════════ */
        .footer { flex-shrink: 0; padding-top: 0.75rem; }
        .footer-info { display: flex; justify-content: space-between; font-size: 8px; color: var(--dim); margin-bottom: 3px; letter-spacing: 0.1em; }
        .progress-track { width: 100%; height: 2px; background: rgba(255,255,255,0.04); overflow: hidden; border-radius: 1px; }
        .progress-fill { height: 100%; width: 0; background: var(--accent); box-shadow: 0 0 10px var(--accent-glow); transition: width 0.5s cubic-bezier(0.22,1,0.36,1); }

        /* ═══════════════ RESPONSIVE ═══════════════ */
        @media (max-height: 600px) {
            .orb-loader { width: 55px; height: 55px; }
            .orb-fill { width: 55px !important; height: 55px !important; }
            .orb-loader > svg { width: 55px !important; height: 55px !important; }
            .orb-wrap { margin-bottom: 1rem; }
            .letter-wave span { font-size: 1.4rem; }
            .boot-lines { margin: 0.75rem 0; }
            .boot-line { font-size: 9px; margin-bottom: 3px; }
            .start-btn { padding: 10px 20px; font-size: 12px; }
            .result-orb-wrap { width: 100px; height: 100px; margin-bottom: 1rem; }
            .result-score { font-size: 2.2rem; }
            .q-text { margin-bottom: 1.5rem; }
            .answers { gap: 6px; }
            .ans-btn { padding: 10px 12px; font-size: 11px; }
        }

        @media (max-height: 500px) {
            .orb-wrap { display: none; }
            .letter-wave span { font-size: 1.2rem; }
            .result-orb-wrap { width: 80px; height: 80px; margin-bottom: 0.75rem; }
            .result-score { font-size: 1.8rem; }
        }

        @media (min-width: 500px) {
            .app { padding-left: 2rem; padding-right: 2rem; }
        }
    </style>
</head>
<body>
    <div class="noise"></div>
    <div class="scanline"></div>
    <div class="grid-bg"></div>

    <div class="app">
        <!-- Header -->
        <div class="header">
            <div>
                <div class="header-label">System</div>
                <div class="header-title">BELKIS_OS v3.0</div>
            </div>
            <div style="text-align:right">
                <div class="header-label">Status</div>
                <div class="header-status" id="status-display">STANDBY</div>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">

            <!-- ════ START SCREEN ════ -->
            <div class="screen fade-in" id="screen-start">
                <!-- Morph Orb — single correct SVG -->
                <div class="orb-wrap">
                    <div class="orb-loader">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <defs>
                                <mask id="morph-mask">
                                    <polygon points="0,0 100,0 100,100 0,100" fill="black"/>
                                    <polygon points="25,25 75,25 50,75" fill="white"/>
                                    <polygon points="50,25 75,75 25,75" fill="white"/>
                                    <polygon points="35,35 65,35 50,65" fill="white"/>
                                    <polygon points="35,35 65,35 50,65" fill="white"/>
                                    <polygon points="35,35 65,35 50,65" fill="white"/>
                                    <polygon points="35,35 65,35 50,65" fill="white"/>
                                </mask>
                            </defs>
                        </svg>
                        <div class="orb-fill"></div>
                    </div>
                </div>

                <!-- Letter Wave Title -->
                <div class="letter-wave" id="title-letters"></div>
                <div class="letter-wave" id="title-letters-2" style="margin-bottom: 0.25rem;"></div>

                <!-- Boot Lines -->
                <div class="boot-lines" id="boot-lines"></div>

                <!-- Start Button -->
                <button class="start-btn" id="start-btn" onclick="app.start()" style="opacity:0; pointer-events:none;">
                    <span>SCAN STARTEN</span>
                    <span class="arrow">→</span>
                </button>
            </div>

            <!-- ════ QUESTION SCREEN ════ -->
            <div class="screen hidden" id="screen-question">
                <div class="scan-orb"></div>
                <div class="q-header">
                    <span class="q-badge" id="q-badge">01</span>
                    <span class="q-module" id="q-module">SECTOR: BIO</span>
                </div>
                <div class="q-text" id="q-text">Frage lädt...</div>
                <div class="answers" id="answers-box"></div>
            </div>

            <!-- ════ RESULT SCREEN ════ -->
            <div class="screen hidden" id="screen-result">
                <div class="result-orb-wrap">
                    <div class="result-orb-ring"></div>
                    <div class="result-orb-ring"></div>
                    <div class="result-orb-ring"></div>
                    <div class="result-score" id="result-score">00<span class="unit">%</span></div>
                </div>

                <div class="result-divider"></div>

                <div class="result-grid">
                    <div class="result-cell">
                        <div class="result-cell-label">Bio</div>
                        <div class="result-cell-val" id="val-bio">--</div>
                        <div class="result-cell-bar"><div class="result-cell-bar-fill" id="bar-bio"></div></div>
                    </div>
                    <div class="result-cell">
                        <div class="result-cell-label">Neuro</div>
                        <div class="result-cell-val" id="val-neuro">--</div>
                        <div class="result-cell-bar"><div class="result-cell-bar-fill" id="bar-neuro"></div></div>
                    </div>
                    <div class="result-cell">
                        <div class="result-cell-label">Core</div>
                        <div class="result-cell-val" id="val-core">--</div>
                        <div class="result-cell-bar"><div class="result-cell-bar-fill" id="bar-core"></div></div>
                    </div>
                </div>

                <div class="result-title" id="res-title">STATUS</div>
                <div class="result-desc" id="res-desc">Analyse wird durchgeführt...</div>

                <button class="reboot-btn" onclick="app.restart()">[ REBOOT SYSTEM ]</button>
            </div>

        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-info">
                <span id="progress-pct">0%</span>
                <span id="footer-label">INITIALIZING...</span>
            </div>
            <div class="progress-track">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>
    </div>

    <script>
    const modules = {
        bio: [
            { q: "Schlaf-Qualität (Letzte Nacht)", a: [{t:"Kritisch (0-4h)",s:0},{t:"Akzeptabel (5-6h)",s:5},{t:"Optimal (7-8h+)",s:10}] },
            { q: "Hydration & Nahrung", a: [{t:"Leer / Dehydriert",s:0},{t:"Kaffee-basiert",s:4},{t:"Gut versorgt",s:10}] },
            { q: "Körperliche Spannung", a: [{t:"Schmerzen / Steif",s:0},{t:"Spürbar",s:5},{t:"Locker / Fit",s:10}] }
        ],
        neuro: [
            { q: "Fokus-Level aktuell", a: [{t:"Scattered (Zerstreut)",s:0},{t:"Multitasking",s:4},{t:"Laser Focus",s:10}] },
            { q: "Mentale Klarheit", a: [{t:"Brain Fog (Nebel)",s:0},{t:"Verrauscht",s:5},{t:"HD Clarity",s:10}] },
            { q: "Informations-Input", a: [{t:"Overload (Zu viel)",s:0},{t:"Verarbeitbar",s:5},{t:"Strukturiert",s:10}] }
        ],
        core: [
            { q: "Stress-Pegel", a: [{t:"Kritisch Hoch",s:0},{t:"Erhöht",s:5},{t:"Zen / Ruhig",s:10}] },
            { q: "Motivation / Drive", a: [{t:"System Error (Keine)",s:0},{t:"Standby",s:5},{t:"Vollgas",s:10}] },
            { q: "Soziale Batterie", a: [{t:"Entladen (Isolation)",s:0},{t:"Low Power",s:5},{t:"Bereit",s:10}] }
        ]
    };

    const flatData = [];
    ['bio','neuro','core'].forEach(cat => {
        modules[cat].forEach(item => flatData.push({...item, category: cat}));
    });

    function buildLetterWave(id, text, baseDelay) {
        const el = document.getElementById(id);
        el.innerHTML = '';
        [...text].forEach((ch, i) => {
            const s = document.createElement('span');
            if (ch === ' ') { s.className = 'space'; }
            else { s.textContent = ch; }
            s.style.animationDelay = `${baseDelay + i * 0.07}s`;
            el.appendChild(s);
        });
    }

    const bootMsgs = [
        { text: "BOOT SEQUENCE INITIATED", delay: 300 },
        { text: "CHECKING BIO-METRICS...", delay: 650 },
        { text: "CHECKING NEURO-LINKS...", delay: 1000 },
        { text: "CHECKING CORE-STABILITY...", delay: 1350 },
        { text: "ALL MODULES READY", delay: 1800 }
    ];

    function runBoot() {
        const box = document.getElementById('boot-lines');
        box.innerHTML = '';
        bootMsgs.forEach((msg, i) => {
            setTimeout(() => {
                const line = document.createElement('div');
                line.className = 'boot-line';
                const last = i === bootMsgs.length - 1;
                line.innerHTML = `<span class="check">${last ? '✓' : '>'}</span> ${msg.text}`;
                box.appendChild(line);
                if (last) {
                    setTimeout(() => {
                        const btn = document.getElementById('start-btn');
                        btn.style.opacity = '1';
                        btn.style.pointerEvents = 'auto';
                        btn.style.animation = 'fadeIn 0.5s ease forwards';
                    }, 350);
                }
            }, msg.delay);
        });
    }

    const app = {
        idx: 0,
        scores: { bio:0, neuro:0, core:0 },
        total: 0,
        maxCat: 30,
        maxTotal: 90,
        busy: false,

        init() {
            buildLetterWave('title-letters', 'FULL SYSTEM', 0);
            buildLetterWave('title-letters-2', 'DIAGNOSTIC', 0.75);
            runBoot();
        },

        switchScreen(from, to) {
            if (app.busy) return;
            app.busy = true;
            const f = document.getElementById(from);
            const t = document.getElementById(to);
            f.classList.add('fade-out');
            setTimeout(() => {
                f.classList.add('hidden');
                f.classList.remove('fade-out', 'fade-in');
                t.classList.remove('hidden');
                t.classList.add('fade-in');
                t.scrollTop = 0;
                app.busy = false;
            }, 300);
        },

        start() {
            app.idx = 0;
            app.scores = { bio:0, neuro:0, core:0 };
            app.total = 0;
            document.getElementById('footer-label').textContent = 'UPLOADING DATA...';
            app.switchScreen('screen-start', 'screen-question');
            setTimeout(() => app.loadQ(), 350);
        },

        loadQ() {
            const item = flatData[app.idx];
            document.getElementById('q-badge').textContent = String(app.idx + 1).padStart(2, '0');
            document.getElementById('q-module').textContent = `SECTOR: ${item.category.toUpperCase()}`;
            document.getElementById('status-display').textContent = `SCANNING ${item.category.toUpperCase()}...`;

            const pct = Math.round((app.idx / flatData.length) * 100);
            document.getElementById('progress-fill').style.width = pct + '%';
            document.getElementById('progress-pct').textContent = pct + '%';

            const qText = document.getElementById('q-text');
            qText.classList.remove('anim-in');
            void qText.offsetWidth;
            qText.textContent = item.q;
            qText.classList.add('anim-in');

            const box = document.getElementById('answers-box');
            box.innerHTML = '';
            item.a.forEach((ans, i) => {
                const btn = document.createElement('button');
                btn.className = 'ans-btn';
                btn.style.animationDelay = `${i * 0.08}s`;
                btn.innerHTML = `<span class="opt-tag">[${i + 1}]</span>${ans.t}`;
                btn.onclick = () => app.answer(btn, ans.s, item.category);
                box.appendChild(btn);
            });
        },

        answer(btn, pts, cat) {
            if (app.busy) return;
            btn.classList.add('selected');
            app.scores[cat] += pts;
            app.total += pts;
            app.idx++;
            setTimeout(() => {
                if (app.idx < flatData.length) app.loadQ();
                else app.finish();
            }, 220);
        },

        finish() {
            app.switchScreen('screen-question', 'screen-result');
            document.getElementById('progress-fill').style.width = '100%';
            document.getElementById('progress-pct').textContent = '100%';
            document.getElementById('status-display').textContent = 'COMPLETED';
            document.getElementById('footer-label').textContent = 'DIAGNOSTIC COMPLETE';

            const tp = Math.round((app.total / app.maxTotal) * 100);
            const bp = Math.round((app.scores.bio / app.maxCat) * 100);
            const np = Math.round((app.scores.neuro / app.maxCat) * 100);
            const cp = Math.round((app.scores.core / app.maxCat) * 100);

            setTimeout(() => {
                app.countUp('result-score', tp, '%');
                document.getElementById('val-bio').textContent = bp + '%';
                document.getElementById('val-neuro').textContent = np + '%';
                document.getElementById('val-core').textContent = cp + '%';

                setTimeout(() => {
                    document.getElementById('bar-bio').style.width = bp + '%';
                    document.getElementById('bar-neuro').style.width = np + '%';
                    document.getElementById('bar-core').style.width = cp + '%';
                }, 200);

                let color, title, desc;
                if (tp < 40) {
                    color = '#ef4444';
                    title = 'SYSTEM FAILURE IMMINENT';
                    desc = 'Kritischer Systemzustand. Sofortiger Shutdown erforderlich. Keine weiteren Tasks annehmen. Schlaf & Nahrung priorisieren.';
                } else if (tp < 75) {
                    color = '#eab308';
                    title = 'MAINTENANCE REQUIRED';
                    desc = 'System läuft, aber Effizienz ist beeinträchtigt. Wartung (Pause/Sport) empfohlen bevor Deep Work gestartet wird.';
                } else {
                    color = '#22c55e';
                    title = 'ALL SYSTEMS GO';
                    desc = 'Maximale Leistung verfügbar. Ready for deployment. Nutze diesen Zustand für High-Priority Projekte.';
                }

                document.getElementById('res-title').textContent = title;
                document.getElementById('res-title').style.color = color;
                document.getElementById('res-desc').textContent = desc;

                const pf = document.getElementById('progress-fill');
                pf.style.background = color;
                pf.style.boxShadow = `0 0 15px ${color}`;

                document.querySelectorAll('.result-orb-ring').forEach(r => {
                    r.style.borderTopColor = color;
                    r.style.borderRightColor = color;
                    r.style.borderBottomColor = color;
                });
            }, 450);
        },

        countUp(elId, target, suffix) {
            const el = document.getElementById(elId);
            let cur = 0;
            const step = Math.max(1, Math.ceil(target / 35));
            const iv = setInterval(() => {
                cur = Math.min(cur + step, target);
                el.innerHTML = `${cur}<span class="unit">${suffix}</span>`;
                if (cur >= target) clearInterval(iv);
            }, 25);
        },

        restart() { location.reload(); }
    };

    app.init();
    </script>
</body>
</html>
